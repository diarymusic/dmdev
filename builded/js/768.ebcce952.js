"use strict";(self["webpackChunkdm"]=self["webpackChunkdm"]||[]).push([[768],{3768:function(t,e,a){a.r(e),a.d(e,{default:function(){return A}});var s=a(9199);const n=t=>((0,s.dD)("data-v-25f855d3"),t=t(),(0,s.Cn)(),t),l={id:"page",class:"site"},o={class:"container"},i={class:"row justify-content-center align-items-center g-2"},r=n((()=>(0,s._)("div",{class:"col-xs-8 col-sm-10 col-md-6 col-lg-6"},[(0,s._)("div",{class:"hero text-black dark:text-white"},[(0,s._)("h1",{class:"typing","data-text":"登录到Diary Music 官网."}," 登录到Diary Music 官网. "),(0,s._)("p",null,[(0,s.Uk)(" 如果您没有账号,您将无法使用Diary Music 官网的完整功能,"),(0,s._)("br"),(0,s.Uk)("您可 "),(0,s._)("a",{href:"#/register"},"在此注册"),(0,s.Uk)(". ")])])],-1))),c={class:"col-xs-8 col-sm-10 col-md-6 col-lg-6"},d={class:"login"},u={class:"main"},p={class:"side-icon text-black"},m=n((()=>(0,s._)("i",{class:"ri-mail-line"},null,-1))),f={class:"side-icon text-black"},h=n((()=>(0,s._)("i",{class:"ri-eye-off-line"},null,-1))),g={class:"side-icon text-black"},v={class:"row justify-content-center align-items-center"},_={class:"col-8",id:"vfi"},b={class:"col-4 text-black",id:"vfb"},y=n((()=>(0,s._)("span",{class:"spinner-border spinner-border-sm d-none",role:"status","aria-hidden":"true",id:"vfsp"},null,-1))),k=n((()=>(0,s._)("span",{class:"text-black"},"发送",-1))),w=[y,k];function x(t,e,a,n,y,k){const x=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("div",o,[(0,s._)("div",i,[r,(0,s._)("div",c,[(0,s._)("div",d,[(0,s._)("div",u,[(0,s._)("form",null,[(0,s._)("p",p,[(0,s.wy)((0,s._)("input",{class:"text-black",type:"email","onUpdate:modelValue":e[0]||(e[0]=t=>y.em=t),placeholder:"您的邮箱地址",autocomplete:"email",autofocus:""},null,512),[[s.nr,y.em]]),m]),(0,s._)("p",f,[(0,s.wy)((0,s._)("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=t=>y.pw=t),placeholder:"您的密码",autocomplete:"current-password"},null,512),[[s.nr,y.pw]]),h]),(0,s._)("div",g,[(0,s._)("div",v,[(0,s._)("div",_,[(0,s.wy)((0,s._)("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=t=>y.vf=t),placeholder:"验证码"},null,512),[[s.nr,y.vf]])]),(0,s._)("div",b,[(0,s._)("button",{type:"button",class:"send",onClick:e[3]||(e[3]=(...t)=>k.sendVerf&&k.sendVerf(...t))},w)])]),(0,s.Wm)(x,{to:"/forgot"},{default:(0,s.w5)((()=>[(0,s.Uk)("忘记密码")])),_:1})]),(0,s._)("p",null,[(0,s._)("input",{type:"button",class:"submit",value:"登录",onClick:e[4]||(e[4]=(...t)=>k.login&&k.login(...t))})])])])])])])])])}var S=a(7387),U=a.n(S);new Array(1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998);var C=a(7970),I=a.n(C);const T='<div class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false">\n                            <div class="toast-header">\n                                <img src="" class="rounded me-2" alt="">\n                                <strong class="me-auto">{{msg}}</strong>\n                                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>\n                            </div>\n                        </div>';function j(){var t=[].slice.call(document.querySelectorAll(".toast")),e=t.map((function(t){return new bootstrap.Toast(t)}));e[e.length-1].show()}var D={data(){return{flag:!1,em:"",pw:"",vf:""}},methods:{eyeOnOff(){this.flag?(U()("#eyeInput").attr("type","password"),U()("#eye").attr("class","ri-eye-off-line"),this.flag=!1):(U()("#eyeInput").attr("type","text"),U()("#eye").attr("class","ri-eye-line"),this.flag=!0)},sendVerf(){null!==this.em&&fetch(`/api/sendCode/${this.em}`).then((t=>t.json())).then((t=>{let e={msg:"发送失败"};e.msg=200==t.status?"发送成功":"发送失败",U()(I().compile(T)(e).toString()).appendTo(".toast-container"),j()}))},login(){if(""!==this.em.toString()&&""!==this.pw.toString()&&""!==this.vf.toString()){let t=new FormData;t.append("em",this.em),t.append("pw",b64_sha256(this.pw)),t.append("vf",this.vf),fetch("/api/login",{method:"post",body:t}).then((t=>t.json())).then((t=>{let e={msg:"登录失败"};200==t.status&&(location.hash="#/"),e.msg=200==t.status?`登录成功，登录有效期为${t.expires}`:"登录失败",U()(I().compile(T)(e).toString()).appendTo(".toast-container"),j(),fetch("/api/getUserInfo",{headers:{Token:localStorage.token}}).then((t=>t.json())).then((t=>{if(200==t.status){var e=null===t.data.alia?t.data.username:t.data.alia;this.user={name:e,ava:t.data.avatar,uid:t.data.id},this.isLogin=0==t.guest}else localStorage.setItem("token",t.token),fetch("/api/getUserInfo",{headers:{Token:localStorage.token}}).then((t=>t.json())).then((t=>{if(200==t.status)var e=null===t.data.alia?t.data.username:t.data.alia;this.user={name:e,ava:t.data.avatar,uid:t.data.id},this.isLogin=0==t.guest}))})),200==t.status&&localStorage.setItem("token",t.token)})).catch((t=>{U()(I().compile(T)({msg:"登录失败"}).toString()).appendTo(".toast-container"),j(),console.error(t)})).finally()}else U()(I().compile(T)({msg:"登录失败（请勿留空信息）"}).toString()).appendTo(".toast-container"),j()}},created(){},mounted(){}},V=a(89);const M=(0,V.Z)(D,[["render",x],["__scopeId","data-v-25f855d3"]]);var A=M}}]);
//# sourceMappingURL=768.ebcce952.js.map